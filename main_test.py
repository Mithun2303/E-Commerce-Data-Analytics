from fastapi.testclient import TestClient
from fastapi import status
from models.customer import customer_model
from main import app

client = TestClient(app = app)

def test_customer_details():

    response = client.get('/customer/cust1140')
    assert response.status_code == 404
    assert response.json() == {"detail":"User not found"}
    response = client.get('/customer/cust_1140')
    assert response.status_code == 200
    assert response.json() == {"customer_name":"PATRICK JONES","province":"NEW BRUNSWICK","region":"ATLANTIC","no_of_orders":30,"orders_placed":[{"order":{"order_id":"Ord_3039","order_date":"2010-08-23","order_priority":"HIGH"},"product":{"product_category":"TECHNOLOGY","product_sub_category":"COMPUTER PERIPHERALS","product_id":"Prod_8"},"shipping":{"mode":"REGULAR AIR","id":"SHP_4217","date":"2010-08-25"},"days_taken_for_delivery":2,"sales":7518.12,"discount":0.04,"order_Quantity":48,"profit":1027.63,"shipping_Cost":6.5,"product_base_margin":0.74},{"order":{"order_id":"Ord_3040","order_date":"2011-03-18","order_priority":"NOT SPECIFIED"},"product":{"product_category":"OFFICE SUPPLIES","product_sub_category":"APPLIANCES","product_id":"Prod_2"},"shipping":{"mode":"REGULAR AIR","id":"SHP_4218","date":"2011-03-19"},"days_taken_for_delivery":1,"sales":374.38,"discount":0.03,"order_Quantity":42,"profit":-1.16,"shipping_Cost":3.5,"product_base_margin":0.58},{"order":{"order_id":"Ord_3040","order_date":"2011-03-18","order_priority":"NOT SPECIFIED"},"product":{"product_category":"TECHNOLOGY","product_sub_category":"COMPUTER PERIPHERALS","product_id":"Prod_8"},"shipping":{"mode":"REGULAR AIR","id":"SHP_4219","date":"2011-03-20"},"days_taken_for_delivery":2,"sales":1557.42,"discount":0.01,"order_Quantity":21,"profit":-123.81,"shipping_Cost":4.0,"product_base_margin":0.79},{"order":{"order_id":"Ord_3040","order_date":"2011-03-18","order_priority":"NOT SPECIFIED"},"product":{"product_category":"FURNITURE","product_sub_category":"OFFICE FURNISHINGS","product_id":"Prod_5"},"shipping":{"mode":"REGULAR AIR","id":"SHP_4219","date":"2011-03-20"},"days_taken_for_delivery":2,"sales":410.27,"discount":0.08,"order_Quantity":14,"profit":226.72,"shipping_Cost":3.92,"product_base_margin":0.44},{"order":{"order_id":"Ord_3040","order_date":"2011-03-18","order_priority":"NOT SPECIFIED"},"product":{"product_category":"TECHNOLOGY","product_sub_category":"OFFICE MACHINES","product_id":"Prod_17"},"shipping":{"mode":"DELIVERY TRUCK","id":"SHP_4220","date":"2011-03-18"},"days_taken_for_delivery":0,"sales":1531.93,"discount":0.1,"order_Quantity":18,"profit":326.56,"shipping_Cost":14.0,"product_base_margin":0.36},{"order":{"order_id":"Ord_3044","order_date":"2010-09-09","order_priority":"NOT SPECIFIED"},"product":{"product_category":"OFFICE SUPPLIES","product_sub_category":"BINDERS AND BINDER ACCESSORIES","product_id":"Prod_3"},"shipping":{"mode":"REGULAR AIR","id":"SHP_4226","date":"2010-09-10"},"days_taken_for_delivery":1,"sales":164.62,"discount":0.03,"order_Quantity":31,"profit":-93.71,"shipping_Cost":5.74,"product_base_margin":0.36},{"order":{"order_id":"Ord_3044","order_date":"2010-09-09","order_priority":"NOT SPECIFIED"},"product":{"product_category":"FURNITURE","product_sub_category":"BOOKCASES","product_id":"Prod_10"},"shipping":{"mode":"DELIVERY TRUCK","id":"SHP_4227","date":"2010-09-12"},"days_taken_for_delivery":3,"sales":4225.77,"discount":0.08,"order_Quantity":36,"profit":-1393.69,"shipping_Cost":58.64,"product_base_margin":0.75},{"order":{"order_id":"Ord_3044","order_date":"2010-09-09","order_priority":"NOT SPECIFIED"},"product":{"product_category":"OFFICE SUPPLIES","product_sub_category":"LABELS","product_id":"Prod_12"},"shipping":{"mode":"REGULAR AIR","id":"SHP_4228","date":"2010-09-11"},"days_taken_for_delivery":2,"sales":53.89,"discount":0.01,"order_Quantity":8,"profit":17.63,"shipping_Cost":0.5,"product_base_margin":0.39},{"order":{"order_id":"Ord_3054","order_date":"2010-02-25","order_priority":"NOT SPECIFIED"},"product":{"product_category":"OFFICE SUPPLIES","product_sub_category":"STORAGE & ORGANIZATION","product_id":"Prod_1"},"shipping":{"mode":"REGULAR AIR","id":"SHP_4243","date":"2010-02-27"},"days_taken_for_delivery":2,"sales":383.81,"discount":0.03,"order_Quantity":32,"profit":-21.15,"shipping_Cost":4.81,"product_base_margin":0.58},{"order":{"order_id":"Ord_3068","order_date":"2009-11-02","order_priority":"LOW"},"product":{"product_category":"OFFICE SUPPLIES","product_sub_category":"BINDERS AND BINDER ACCESSORIES","product_id":"Prod_3"},"shipping":{"mode":"REGULAR AIR","id":"SHP_4260","date":"2009-11-04"},"days_taken_for_delivery":2,"sales":56.22,"discount":0.04,"order_Quantity":6,"profit":-20.39,"shipping_Cost":6.19,"product_base_margin":0.38},{"order":{"order_id":"Ord_3068","order_date":"2009-11-02","order_priority":"LOW"},"product":{"product_category":"OFFICE SUPPLIES","product_sub_category":"RUBBER BANDS","product_id":"Prod_7"},"shipping":{"mode":"REGULAR AIR","id":"SHP_4261","date":"2009-11-06"},"days_taken_for_delivery":4,"sales":107.96,"discount":0.01,"order_Quantity":30,"profit":13.24,"shipping_Cost":1.63,"product_base_margin":0.36},{"order":{"order_id":"Ord_3068","order_date":"2009-11-02","order_priority":"LOW"},"product":{"product_category":"FURNITURE","product_sub_category":"TABLES","product_id":"Prod_11"},"shipping":{"mode":"DELIVERY TRUCK","id":"SHP_4262","date":"2009-11-09"},"days_taken_for_delivery":7,"sales":3169.992,"discount":0.08,"order_Quantity":40,"profit":-973.3,"shipping_Cost":41.64,"product_base_margin":0.75},{"order":{"order_id":"Ord_3070","order_date":"2012-07-12","order_priority":"NOT SPECIFIED"},"product":{"product_category":"TECHNOLOGY","product_sub_category":"COMPUTER PERIPHERALS","product_id":"Prod_8"},"shipping":{"mode":"REGULAR AIR","id":"SHP_4264","date":"2012-07-14"},"days_taken_for_delivery":2,"sales":236.32,"discount":0.03,"order_Quantity":3,"profit":-339.95,"shipping_Cost":4.0,"product_base_margin":0.76},{"order":{"order_id":"Ord_3072","order_date":"2012-11-10","order_priority":"HIGH"},"product":{"product_category":"OFFICE SUPPLIES","product_sub_category":"PENS & ART SUPPLIES","product_id":"Prod_13"},"shipping":{"mode":"REGULAR AIR","id":"SHP_4266","date":"2012-11-12"},"days_taken_for_delivery":2,"sales":6.77,"discount":0.06,"order_Quantity":1,"profit":-3.66,"shipping_Cost":4.28,"product_base_margin":0.44},{"order":{"order_id":"Ord_3089","order_date":"2009-07-17","order_priority":"MEDIUM"},"product":{"product_category":"FURNITURE","product_sub_category":"OFFICE FURNISHINGS","product_id":"Prod_5"},"shipping":{"mode":"REGULAR AIR","id":"SHP_4286","date":"2009-07-17"},"days_taken_for_delivery":0,"sales":86.7,"discount":0.07,"order_Quantity":50,"profit":-185.34,"shipping_Cost":4.86,"product_base_margin":0.41},{"order":{"order_id":"Ord_3091","order_date":"2012-06-04","order_priority":"CRITICAL"},"product":{"product_category":"OFFICE SUPPLIES","product_sub_category":"PAPER","product_id":"Prod_6"},"shipping":{"mode":"REGULAR AIR","id":"SHP_4288","date":"2012-06-06"},"days_taken_for_delivery":2,"sales":623.35,"discount":0.03,"order_Quantity":16,"profit":235.51,"shipping_Cost":5.08,"product_base_margin":0.38},{"order":{"order_id":"Ord_3097","order_date":"2009-01-03","order_priority":"HIGH"},"product":{"product_category":"OFFICE SUPPLIES","product_sub_category":"BINDERS AND BINDER ACCESSORIES","product_id":"Prod_3"},"shipping":{"mode":"REGULAR AIR","id":"SHP_4295","date":"2009-01-04"},"days_taken_for_delivery":1,"sales":172.51,"discount":0.03,"order_Quantity":29,"profit":12.55,"shipping_Cost":2.99,"product_base_margin":0.37},{"order":{"order_id":"Ord_3097","order_date":"2009-01-03","order_priority":"HIGH"},"product":{"product_category":"FURNITURE","product_sub_category":"TABLES","product_id":"Prod_11"},"shipping":{"mode":"DELIVERY TRUCK","id":"SHP_4296","date":"2009-01-04"},"days_taken_for_delivery":1,"sales":698.0,"discount":0.09,"order_Quantity":4,"profit":-93.16,"shipping_Cost":52.2,"product_base_margin":0.64},{"order":{"order_id":"Ord_3099","order_date":"2010-12-01","order_priority":"LOW"},"product":{"product_category":"TECHNOLOGY","product_sub_category":"TELEPHONES AND COMMUNICATION","product_id":"Prod_4"},"shipping":{"mode":"REGULAR AIR","id":"SHP_4298","date":"2010-12-08"},"days_taken_for_delivery":7,"sales":1541.458,"discount":0.05,"order_Quantity":34,"profit":-238.16,"shipping_Cost":5.0,"product_base_margin":0.83},{"order":{"order_id":"Ord_3102","order_date":"2010-09-19","order_priority":"LOW"},"product":{"product_category":"TECHNOLOGY","product_sub_category":"TELEPHONES AND COMMUNICATION","product_id":"Prod_4"},"shipping":{"mode":"EXPRESS AIR","id":"SHP_4302","date":"2010-09-23"},"days_taken_for_delivery":4,"sales":845.614,"discount":0.01,"order_Quantity":5,"profit":-653.49,"shipping_Cost":4.2,"product_base_margin":0.6},{"order":{"order_id":"Ord_3106","order_date":"2009-10-28","order_priority":"CRITICAL"},"product":{"product_category":"OFFICE SUPPLIES","product_sub_category":"PAPER","product_id":"Prod_6"},"shipping":{"mode":"REGULAR AIR","id":"SHP_4307","date":"2009-10-30"},"days_taken_for_delivery":2,"sales":856.9,"discount":0.02,"order_Quantity":43,"profit":106.93,"shipping_Cost":9.54,"product_base_margin":0.37},{"order":{"order_id":"Ord_3111","order_date":"2012-05-26","order_priority":"HIGH"},"product":{"product_category":"OFFICE SUPPLIES","product_sub_category":"APPLIANCES","product_id":"Prod_2"},"shipping":{"mode":"REGULAR AIR","id":"SHP_4315","date":"2012-05-28"},"days_taken_for_delivery":2,"sales":1944.87,"discount":0.06,"order_Quantity":49,"profit":496.43,"shipping_Cost":4.5,"product_base_margin":0.56},{"order":{"order_id":"Ord_3111","order_date":"2012-05-26","order_priority":"HIGH"},"product":{"product_category":"OFFICE SUPPLIES","product_sub_category":"BINDERS AND BINDER ACCESSORIES","product_id":"Prod_3"},"shipping":{"mode":"REGULAR AIR","id":"SHP_4316","date":"2012-05-27"},"days_taken_for_delivery":1,"sales":61.82,"discount":0.1,"order_Quantity":12,"profit":-10.45,"shipping_Cost":2.99,"product_base_margin":0.38},{"order":{"order_id":"Ord_3115","order_date":"2012-09-18","order_priority":"MEDIUM"},"product":{"product_category":"OFFICE SUPPLIES","product_sub_category":"BINDERS AND BINDER ACCESSORIES","product_id":"Prod_3"},"shipping":{"mode":"EXPRESS AIR","id":"SHP_4323","date":"2012-09-19"},"days_taken_for_delivery":1,"sales":76.38,"discount":0.03,"order_Quantity":13,"profit":-29.69,"shipping_Cost":5.24,"product_base_margin":0.39},{"order":{"order_id":"Ord_3115","order_date":"2012-09-18","order_priority":"MEDIUM"},"product":{"product_category":"TECHNOLOGY","product_sub_category":"COMPUTER PERIPHERALS","product_id":"Prod_8"},"shipping":{"mode":"REGULAR AIR","id":"SHP_4324","date":"2012-09-19"},"days_taken_for_delivery":1,"sales":2948.63,"discount":0.05,"order_Quantity":29,"profit":888.62,"shipping_Cost":7.18,"product_base_margin":0.46},{"order":{"order_id":"Ord_3115","order_date":"2012-09-18","order_priority":"MEDIUM"},"product":{"product_category":"OFFICE SUPPLIES","product_sub_category":"PAPER","product_id":"Prod_6"},"shipping":{"mode":"REGULAR AIR","id":"SHP_4325","date":"2012-09-18"},"days_taken_for_delivery":0,"sales":18.33,"discount":0.09,"order_Quantity":4,"profit":-7.08,"shipping_Cost":2.97,"product_base_margin":0.35},{"order":{"order_id":"Ord_3116","order_date":"2012-01-06","order_priority":"CRITICAL"},"product":{"product_category":"OFFICE SUPPLIES","product_sub_category":"APPLIANCES","product_id":"Prod_2"},"shipping":{"mode":"REGULAR AIR","id":"SHP_4326","date":"2012-01-07"},"days_taken_for_delivery":1,"sales":86.0,"discount":0.05,"order_Quantity":10,"profit":-66.91,"shipping_Cost":9.23,"product_base_margin":0.58},{"order":{"order_id":"Ord_3116","order_date":"2012-01-06","order_priority":"CRITICAL"},"product":{"product_category":"OFFICE SUPPLIES","product_sub_category":"APPLIANCES","product_id":"Prod_2"},"shipping":{"mode":"REGULAR AIR","id":"SHP_4327","date":"2012-01-08"},"days_taken_for_delivery":2,"sales":4805.36,"discount":0.04,"order_Quantity":13,"profit":1127.31,"shipping_Cost":19.99,"product_base_margin":0.57},{"order":{"order_id":"Ord_3117","order_date":"2010-09-07","order_priority":"CRITICAL"},"product":{"product_category":"OFFICE SUPPLIES","product_sub_category":"SCISSORS, RULERS AND TRIMMERS","product_id":"Prod_16"},"shipping":{"mode":"REGULAR AIR","id":"SHP_4328","date":"2010-09-08"},"days_taken_for_delivery":1,"sales":475.92,"discount":0.05,"order_Quantity":36,"profit":-95.3,"shipping_Cost":4.59,"product_base_margin":0.82},{"order":{"order_id":"Ord_3117","order_date":"2010-09-07","order_priority":"CRITICAL"},"product":{"product_category":"OFFICE SUPPLIES","product_sub_category":"PAPER","product_id":"Prod_6"},"shipping":{"mode":"REGULAR AIR","id":"SHP_4328","date":"2010-09-08"},"days_taken_for_delivery":1,"sales":146.71,"discount":0.01,"order_Quantity":36,"profit":38.63,"shipping_Cost":1.3,"product_base_margin":0.37}]}

    response = client.get('/customer/cust_999999')
    assert response.status_code == 204

def test_unique_customers():
    response = client.get('')
    assert response.status_code ==404
    
def test_max_orders():
    payload = {
        "off_set":5
    }
    response = client.get("/maxorder/5/0")
    response.status_code == 200
    response = client.get('/maxorder/5/1900')
    response.status_code==404

def test_orders():
    response = client.get("/order/ord_149")
    response.status_code == 200
    response = client.get("/order/ord_123456789")
    response.status_code == 404

def test_product():
    response = client.get("/product/furniture")
    response.status_code == 200
    response = client.get("/product/furvbsrgniture")
    response.status_code == 404
    
def test_profit():
    response = client.get("/profit")
    response.status_code == 200

def test_sales():
    response = client.get("/sales")
    response.status_code == 200